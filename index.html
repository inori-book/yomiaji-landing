<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>YOMIAJI （βテスト版） | 読み味で探す”毒書”体験</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="読後感＝読み味で本を探す読書アプリ『YOMIAJI（βテスト版）』。ホラー/耽美/背徳の”毒書”体験を。">
  <!-- OG / Twitter -->
  <meta property="og:title" content="YOMIAJI （βテスト版） | 読み味で探す毒書体験">
  <meta property="og:description" content="読後感＝読み味で本を探す読書アプリ。禁忌の本棚を開けよう。">
  <meta property="og:image" content="assets/og.jpg">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=Noto+Serif+JP:wght@400;600&display=swap" rel="stylesheet">
  <!-- Tailwind (CDNビルド) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --ink:#0b0a0a; --paper:#f7f1e3; --burgundy:#6e0f2f; --burgundy-2:#3b0b1b; --sepia:#b08968;
    }
    body{ font-family:'Noto Serif JP','Cormorant Garamond',serif; background:radial-gradient(1200px 800px at 20% -10%, #1a1417, #0b0a0a); color:#eae6e1;}
    .brand{ font-family:'Cormorant Garamond','Noto Serif JP',serif; letter-spacing:.06em }
    .btn{ display:block; width:100%; border-radius:16px; padding:14px 18px; font-weight:600; border:1px solid #5f0f29; background:linear-gradient(90deg,var(--burgundy),var(--burgundy-2));}
    .btn:hover{ filter:saturate(1.1) brightness(1.05)}
    .pill{ background:rgba(110,15,47,.18); border:1px solid rgba(110,15,47,.5); }
    .glass{ background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08); backdrop-filter: blur(6px);}
  </style>
  <!-- DNS prefetch (少しだけ効く) -->
  <link rel="dns-prefetch" href="https://book-sentiment-search-kzufxfzgrgwnnmji6g55am.streamlit.app">
  <link rel="icon" href="assets/favicon.svg">
  <!-- Analytics（Plausible推奨：差し替え） -->
  <!-- <script defer data-domain="yomiaji.example" src="https://plausible.io/js/script.js"></script> -->
  <!-- GA4を使うなら：
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)};gtag('js', new Date());gtag('config','G-XXXXXXX');</script> -->
</head>
<body>
  <main class="min-h-screen">
    <header class="max-w-4xl mx-auto px-5 py-6 flex items-center justify-between">
      <div class="brand text-2xl tracking-wide">YOMIAJI<span class="opacity-60 text-sm ml-2">β</span></div>
    </header>

    <section class="max-w-4xl mx-auto px-5 pt-10 pb-16">
      <div class="text-center mb-12">
        <h1 class="brand text-4xl md:text-5xl leading-tight">
          読み味で選ぶ、<br><span class="text-[var(--sepia)]">禁忌の”毒書”体験</span>
        </h1>
        <p class="mt-4 text-base/7 opacity-90">
          読む前の自分には戻れなくなるような”毒書”を取り揃えております。<br>
          読後感＝読み味から、あなたに合った1冊を探してください。
        </p>

        <!-- 起動状態 -->
        <div id="status" class="mt-6 text-sm opacity-80">起動しています…</div>

        <!-- CTA -->
        <a id="cta" class="btn mt-3 text-center max-w-md mx-auto" href="#" rel="nofollow">アクセスはこちら</a>
        <p class="text-xs opacity-70 mt-2">※初回起動には10秒前後かかる場合があります。</p>
      </div>

      <div class="glass rounded-2xl overflow-hidden max-w-2xl mx-auto">
        <img src="assets/key-visual.webp" alt="YOMIAJIのゴシックなキービジュアル" class="w-full h-full object-cover">
      </div>
    </section>

    <!-- 使い方（3ステップ） -->
    <section class="max-w-4xl mx-auto px-5 pb-20">
      <h3 class="brand text-4xl md:text-5xl leading-tight mb-8">使い方</h3>
      <div class="grid md:grid-cols-3 gap-5">
      <div class="glass p-5 rounded-xl">
        <div class="text-lg mb-2">1. 検索する</div>
        <p class="opacity-80 text-sm">「怖い」「切ない」「グロ」など、読みたい本のテイストに応じたキーワードを入力して検索します。</p>
      </div>
      <div class="glass p-5 rounded-xl">
        <div class="text-lg mb-2">2. 本を選ぶ</div>
        <p class="opacity-80 text-sm">検索したキーワードを感想中に含む本がリストアップされます。購入も可能です（楽天ブックスにリンク）。</p>
      </div>
      <div class="glass p-5 rounded-xl">
        <div class="text-lg mb-2">3. 感想を返す</div>
        <p class="opacity-80 text-sm">読んだ本の感想をぜひ投稿してください。あなたの感想でアプリの検索精度が上がります。</p>
      </div>
      </div>
    </section>

    <footer class="max-w-4xl mx-auto px-5 pb-12 text-xs opacity-70">
      <p>バグ報告・ご意見は<a href="https://x.com/inori_book" target="_blank" class="underline">X（Twitter） @inori_book</a> のDMまでいただけますと幸いです。</p>
      <p>&copy; 2025 YOMIAJI</p>
    </footer>
  </main>

  <script>
    // ====== 設定 ======
    const APP_URL = "https://book-sentiment-search-kzufxfzgrgwnnmji6g55am.streamlit.app";
    const PING_URL = APP_URL + "/?ping=1"; // app.py側でst.query_params['ping']=="1"→即stopするやつ

    const statusEl = document.getElementById("status");
    const ctaEl = document.getElementById("cta");

    // ページ読み込み時にプリウォーム
    let warmed = false;
    async function prewarm(timeoutMs = 10000){
      statusEl.textContent = "起動しています…";
      try{
        const ctrl = new AbortController();
        const id = setTimeout(()=>ctrl.abort(), timeoutMs);
        // no-corsでも実サーバを叩けば起動はする
        await fetch(PING_URL, { mode: "no-cors", keepalive: true, signal: ctrl.signal });
        clearTimeout(id);
        warmed = true;
        statusEl.textContent = "起動完了。アクセスできます";
      }catch(e){
        statusEl.textContent = "起動中…数秒お待ちください（通信が混み合っている場合、時間がかかることがあります）";
      }
    }

    // CTAクリック：別タブで開く（LPは残す）
    ctaEl.addEventListener("click", (e)=>{
      e.preventDefault();
      window.open(APP_URL, "_blank", "noopener");
    });

    // 自動プリウォーム + 数秒おきにリトライ（最大3回）
    document.addEventListener("DOMContentLoaded", async ()=>{
      for(let i=0;i<3 && !warmed;i++){
        await prewarm(8000);
        if(!warmed) await new Promise(r=>setTimeout(r, 3000));
      }
    });
  </script>
</body>
</html>